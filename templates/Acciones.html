<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seleccionar Acciones</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <div class="container">
        <h1>Selecciona las Acciones</h1>

        <h2>Configurar Comportamiento de la IA</h2>
        <label for="rol-ia">Selecciona el Rol de la IA:</label>
        <select id="rol-ia" name="rol">
            <option value="amigable">Amigable</option>
            <option value="experto_negocios">Experto en Negocios</option>
            <option value="técnico">Técnico</option>
            <option value="motivador">Motivador</option>
        </select>

        <!-- Formulario de Competidores y Filtros -->
        <form id="filters-form" enctype="multipart/form-data" style="margin-bottom: 20px;">
            <h2>Configurar Tiempo de Ejecución</h2>
<label for="duracion">Duración de ejecución (horas):</label>
<input type="number" id="duracion" name="duracion" min="1" max="24" value="6">

            <h2>Usuarios de Competencia</h2>
            <label for="competidores">Competidores:</label>
            <textarea id="competidores" name="competidores" rows="3" placeholder="Ingresa competidores separados por comas">{{ competencia }}</textarea>
            <small>Ejemplo: competencia1, competencia2, competencia3</small>
    
            <h2>Configurar Filtros</h2>
            <label for="ubicaciones">Ubicaciones:</label>
            <input type="text" id="ubicaciones" name="ubicaciones" placeholder="Ej: chile, santiago">
    
            <label for="palabras_clave">Palabras clave en la biografía:</label>
            <input type="text" id="palabras_clave" name="palabras_clave" placeholder="Ej: emprendedor, marketing">
    
            <label for="min_publicaciones">Mínimo de Publicaciones:</label>
            <input type="number" id="min_publicaciones" name="min_publicaciones" value="10">
    
            <label for="min_seguidores">Mínimo de Seguidores:</label>
            <input type="number" id="min_seguidores" name="min_seguidores" value="100">
    
            <label for="tipo_cuenta">Tipo de Cuenta:</label>
            <select id="tipo_cuenta" name="tipo_cuenta">
                <option value="publica">Pública</option>
                <option value="privada">Privada</option>
            </select>
            
            <h2>Cargar Mensajes</h2>
                <label for="mensajes-dm">Cargar mensajes para DM:</label>
                <input type="file" id="mensajes-dm" name="mensajes_dm" accept=".txt" multiple>
                <br>
                <label for="mensajes-comentarios">Cargar mensajes para comentarios:</label>
                <input type="file" id="mensajes-comentarios" name="mensajes_comentarios" accept=".txt" multiple>
                <br>
        
            
            <button type="submit">Aplicar Filtros</button>
        </form>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('filters-form').addEventListener('submit', async (event) => {
                event.preventDefault();
                console.log("[DEBUG] Botón 'Iniciar Acciones' presionado.");
    
                const formData = new FormData(event.target);
    
                // Verificar qué datos se están enviando
                console.log("[DEBUG] Datos a enviar:", Object.fromEntries(formData.entries()));
    
                try {
                    // Enviar solicitud al backend a la ruta correcta
                    const response = await fetch('/acciones', {
                        method: 'POST',
                        body: formData,
                    });
    
                    console.log("[DEBUG] Enviando datos al backend...");
    
                    if (!response.ok) {
                        throw new Error(`Error HTTP: ${response.status}`);
                    }
    
                    const data = await response.json();
                    console.log("[DEBUG] Respuesta del backend:", data);
    
                    if (data.success) {
                        alert("Acciones iniciadas correctamente.");
                    } else {
                        alert(`Error: ${data.error}`);
                    }
                } catch (error) {
                    console.error('Error en el proceso:', error);
                    alert('Hubo un problema al iniciar las acciones.');
                }
            });
        });
    </script>
    
    
</body>
</html>
